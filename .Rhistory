x <- seq(2,8,len=100)
y <- seq(15,20,len=100)
W<-c(15,20,11,18,13)
#  M<-matrix(0,10000,3)
nome_do_arquivo <- "dados.txt"
# Abrir o arquivo para escrita
arquivo <- file(nome_do_arquivo, "w")
aux<-1
for(i in 1:100){
for (j in 1:100){
linha <- paste(x[i],y[j],5*log(x[i])-5*x[i]*log(y[j])+(x[i]-1)*sum(log(W))-(1/(y[j]^x[i]))*sum(W^x[i]), collapse = "\t") # Separador de tabulação (\t) entre as colunas
cat(linha, file = arquivo)
cat("\n", file = arquivo)
aux<-aux+1
}
cat("\n", file = arquivo)
#write.table( "",row.names = F, col.names = F,file="dadosn.txt",append = TRUE)
}
close(arquivo)
tabuas<- read.table('Tabuas.txt', header=T)
attach(tabuas)
AX<-function( i, idade,b,tabua)  {
qx<-tabua
px<-1-qx
n<-max(Idade)-idade
v <- (1/(i+1))^(1:n)
pxx <- c(1, cumprod( px[(idade+1):(idade+n-1)]) )
if(n==1){
pxx<-1
}
qxx <- c(qx[(idade+1):(idade+n)])
Ax <- b* sum(v*pxx*qxx)
if(n==0){
Ax<-0
}
return (Ax)
}
AX(0.03,40,1,tabuas$AT_49_qx)
ax<-function(i,idade,b,tabua){
px<- 1-tabua
v <- 1/(1+i)
n<-max(Idade)-idade
pxx    <- c(1, cumprod(px[(idade+1):(length(px)-1)]) )
if(n==1){
pxx<-1
}
t         <- (0:(length(pxx)-1))
if(n==0){
ax<-0
}
ax      <- b*sum(v^(t)*pxx)
return(ax)
}
ax(0.03,40,1,tabuas$AT_49_qx)
p<-AX(0.03,40,1,tabuas$AT_49_qx)/ax(0.03,40,1,tabuas$AT_49_qx)
Vr
p
Vr<-Vrv<-(1:(max(Idade)-40))*0
Vr
Vr[1]<-Vrv[1]<-0
for (i in 1:(max(Idade)-41)){
Vr[i+1]=AX(0.03,40+i,1,tabuas$AT_49_qx)-p*ax(0.03,40+i,1,tabuas$AT_49_qx)
Vrv[i+1]=(AX(0.03,40+i,1,tabuas$AT_49_qx)+0.005*ax(0.03,40+i,1,tabuas$AT_49_qx))-(p)*ax(0.03,40+i,1,tabuas$AT_49_qx)
}
plot(Vr,type='l',ylim=c(0,1),ylab="Reserva",xlab="tempo",lwd=2)
par(new=T)
plot(Vrv,type='l',col='red',ylim=c(0,1),ylab="Reserva",xlab="tempo",lwd=2)
tabuas<- read.table('Tabuas.txt', header=T)
attach(tabuas)
i<-0.03;idade=69;n=1;b=1;tabua<-tabuas$AT_49_qx
Axn<-function( i, idade, n,b,tabua)  {
qx<-tabua
px<-1-qx
v <- (1/(i+1))^(1:n)
pxx <- c(1, cumprod( px[(idade+1):(idade+n-1)]) )
if(n==1){
pxx<-1
}
qxx <- c(qx[(idade+1):(idade+n)])
Axn <- b* sum(v*pxx*qxx)
if(n==0){
Axn<-0
}
return (Axn)
}
anx<-function(i,idade,n,b,tabua){
v       <- 1/(1+i)
px     <- 1-tabua
pxx   <- c(1, cumprod(px[(idade+1):(idade+n-1)]) )
if(n==1){
pxx<-1
}
t        <- (0:(length(pxx)-1))
anx     <- b*sum(v^(t)*pxx)
if(n==0){
anx<-0
}
return(anx)
}
p<-Axn(0.03,1,10,1,tabuas$AT_49_qx)/anx(0.03,1,10,1,tabuas$AT_49_qx);p
Vr<-Vrv<-(0:10)*0
Vr[1]=Vrv[1]=0
for (i in 1:10){
Vr[i+1]=Axn(0.03,(1+i),(10-i),1,tabuas$AT_49_qx)-p*anx(0.03,1+i,10-i,1,tabuas$AT_49_qx)
Vrv[i+1]=(Axn(0.03,2+i,10-i,1,tabuas$AT_49_qx)+0.005*anx(0.03,1+i,10-i,1,tabuas$AT_49_qx))-(p)*anx(0.03,1+i,10-i,1,tabuas$AT_49_qx)
}
plot(Vr,type='b',ylab="Reserva",xlab="tempo",lwd=2,ylim=c(0,0.01))
par(new=T)
plot(Vrv,type='l',col='red',ylab="Reserva",xlab="tempo",lwd=2,ylim=c(0,0.15))
plot(Vr,type='b',ylab="Reserva",xlab="tempo",lwd=2,ylim=c(0,0.01))
par(new=T)
plot(Vrv,type='l',col='red',ylab="Reserva",xlab="tempo",lwd=2,ylim=c(0,0.15))
tabuas<- read.table('Tabuas.txt', header=T)
Axn<-function( i, idade, n,b,tabua)  {
qx<-tabua
px<-1-qx
v <- (1/(i+1))^(1:n)
pxx <- c(1, cumprod( px[(idade+1):(idade+n-1)]) )
if(n==1){
pxx<-1
}
qxx <- c(qx[(idade+1):(idade+n)])
Axn <- b* sum(v*pxx*qxx)
if(n==0){
Axn<-0
}
return (Axn)
}
anx<-function(i,idade,n,b,tabua){
v       <- 1/(1+i)
px     <- 1-tabua
pxx   <- c(1, cumprod(px[(idade+1):(idade+n-1)]) )
if(n==1){
pxx<-1
}
t        <- (0:(length(pxx)-1))
anx     <- b*sum(v^(t)*pxx)
if(n==0){
anx<-0
}
return(anx)
}
p<-Axn(0.03,1,10,1,tabuas$AT_49_qx)/anx(0.03,1,10,1,tabuas$AT_49_qx);p
Vr<-Vrv<-(0:10)*0
Vr[1]=Vrv[1]=0
for (i in 1:10){
Vr[i+1]=Axn(0.03,(1+i),(10-i),1,tabuas$AT_49_qx)-p*anx(0.03,1+i,10-i,1,tabuas$AT_49_qx)
Vrv[i+1]=(Axn(0.03,2+i,10-i,1,tabuas$AT_49_qx)+0.005*anx(0.03,1+i,10-i,1,tabuas$AT_49_qx))-(p)*anx(0.03,1+i,10-i,1,tabuas$AT_49_qx)
}
plot(Vr,type='b',ylab="Reserva",xlab="tempo",lwd=2,ylim=c(0,0.01))
plot(Vr)
p<-Axn(0.03,20,10,1,tabuas$AT_49_qx)/anx(0.03,20,10,1,tabuas$AT_49_qx);p
Vr<-Vrv<-(0:10)*0
Vr[1]=Vrv[1]=0
for (i in 1:10){
Vr[i+1]=Axn(0.03,(10+i),(10-i),1,tabuas$AT_49_qx)-p*anx(0.03,10+i,10-i,1,tabuas$AT_49_qx)
Vrv[i+1]=(Axn(0.03,20+i,10-i,1,tabuas$AT_49_qx)+0.005*anx(0.03,1+i,10-i,1,tabuas$AT_49_qx))-(p)*anx(0.03,1+i,10-i,1,tabuas$AT_49_qx)
}
plot(Vr,type='b',ylab="Reserva",xlab="tempo",lwd=2,ylim=c(0,0.01))
plot(Vr)
plot(Vr,type='b',ylab="Reserva",xlab="tempo",lwd=2)
#----------------------------------------------------------------------------------------
rm(list=ls(all=T))
tabuas<- read.table('Tabuas.txt', header=T)
attach(tabuas)
Axn<-function( i, idade, n,b,tabua)  {
qx<-tabua
px<-1-qx
v <- (1/(i+1))^(1:n)
pxx <- c(1, cumprod( px[(idade+1):(idade+n-1)]) )
if(n==1){
pxx<-1
}
qxx <- c(qx[(idade+1):(idade+n)])
Axn <- b* sum(v*pxx*qxx)
if(n==0){
Axn<-0
}
return (Axn)
}
anx<-function(i,idade,n,b,tabua){
v       <- 1/(1+i)
px     <- 1-tabua
pxx   <- c(1, cumprod(px[(idade+1):(idade+n-1)]) )
if(n==1){
pxx<-1
}
t        <- (0:(length(pxx)-1))
anx     <- b*sum(v^(t)*pxx)
if(n==0){
anx<-0
}
return(anx)
}
tabuas$AT_49_qx
names(tabuas)
i<-0.03; x=30; m=10; n=5
p<-(dotalP(i,x,m,1,tabuas$AT_49_qx)*anx(i,x+m,(max(tabuas$Idade)-x-m)),1,tabuas$AT_49_qx))/anx(i,x,m,1,tabuas$AT_49_qx)
dotalP(i,x,m,1,tabuas$AT_49_qx)
dotalP<-function(i,idade,n,b,tabua){
px<-1-tabua
V <- 1/(i+1)^n
npx <- prod( px[(idade+1):(idade+n)])
Dt<- V*npx*b
return(Dt)
}
dotalP(i,x,m,1,tabuas$AT_49_qx)
anx(i,x+m,(max(tabuas$Idade)-x-m))
(max(tabuas$Idade)
)
tabuas$AT_49_qx
x+m
anx(i,x+m,(max(tabuas$Idade)-x-m)),1,tabuas$AT_49_qx))
(max(tabuas$Idade)-x-m))
(max(tabuas$Idade)-x-m)
p<-(dotalP(i,x,m,1,tabuas$AT_49_qx)*anx(i,x+m,(max(tabuas$Idade)-x-m),1,tabuas$AT_49_qx))/anx(i,x,m,1,tabuas$AT_49_qx)
p
1/100
5/1--
5/100
i <- seq(0.01,0.05,len=100)
id <- 35:60
i  <- seq(0.01,0.05,len=100)
